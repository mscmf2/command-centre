<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1">&lt;meta charset="UTF-8"&gt;</p>
<p class="p1">&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1">&lt;title&gt;Command Centre - Modular System&lt;/title&gt;</p>
<p class="p1">&lt;link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&amp;family=DM+Sans:wght@300;400;500;600&amp;display=swap" rel="stylesheet"&gt;</p>
<p class="p1">&lt;style&gt;</p>
<p class="p1">:root {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>--bg:#F5F2ED; --surface:#FDFBF8; --surface2:#F0EDE8; --border:#E2DDD6;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>--text:#1A1714; --text-muted:#8A8178;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>--accent:#2C5F2E; --accent-light:#E8F0E8;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>--warn:#B8540A; --warn-light:#FEF3E8;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>--danger:#A8200D; --danger-light:#FDECEA;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>--blue:#1B4F8A; --blue-light:#E8EFF8;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>--purple:#5B3A8C; --purple-light:#F0EAF8;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>--yellow:#FFC107; --yellow-light:#FFF9E6;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>--gray:#8A8178; --gray-light:#F0EDE8;</p>
<p class="p1">}</p>
<p class="p1">* { box-sizing:border-box; margin:0; padding:0; }</p>
<p class="p1">body { font-family:'DM Sans',sans-serif; background:var(--bg); color:var(--text); min-height:100vh; font-size:14px; }</p>
<p class="p2"><br></p>
<p class="p1">header { background:var(--text); color:white; padding:0 32px; display:flex; align-items:center; justify-content:space-between; height:60px; position:sticky; top:0; z-index:100; }</p>
<p class="p1">.header-brand { font-family:'DM Serif Display',serif; font-size:20px; }</p>
<p class="p1">.header-right { display:flex; align-items:center; gap:12px; }</p>
<p class="p2"><br></p>
<p class="p1">.user-selector select {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); color:white;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>padding:6px 30px 6px 12px; border-radius:6px; font-size:13px; cursor:pointer; appearance:none;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='white' d='M6 9L1 4h10z'/%3E%3C/svg%3E");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>background-repeat:no-repeat; background-position:right 10px center;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">.sync-status { font-size:11px; color:rgba(255,255,255,0.45); display:flex; align-items:center; gap:5px; }</p>
<p class="p1">.sync-dot { width:6px; height:6px; border-radius:50%; background:#4CAF50; }</p>
<p class="p1">.sync-dot.syncing { background:#FFA726; animation:pulse 1s infinite; }</p>
<p class="p1">@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.4} }</p>
<p class="p2"><br></p>
<p class="p1">.btn-add { background:var(--accent); color:white; border:none; padding:8px 16px; border-radius:6px; font-size:13px; font-weight:500; cursor:pointer; }</p>
<p class="p1">.btn-add:hover { background:#224a24; }</p>
<p class="p2"><br></p>
<p class="p1">.config-banner { background:#FFF8E1; border-bottom:1px solid #FFE082; padding:12px 32px; display:flex; align-items:center; gap:12px; font-size:13px; }</p>
<p class="p1">.config-banner.hidden { display:none; }</p>
<p class="p1">.config-banner input { flex:1; max-width:560px; padding:7px 12px; border:1px solid #FFD54F; border-radius:6px; font-size:13px; }</p>
<p class="p1">.btn-connect { background:#F57F17; color:white; border:none; padding:7px 16px; border-radius:6px; font-size:13px; cursor:pointer; }</p>
<p class="p2"><br></p>
<p class="p1">main { padding:28px 32px; max-width:1400px; margin:0 auto; }</p>
<p class="p2"><br></p>
<p class="p1">.summary-bar { display:grid; grid-template-columns:repeat(4,1fr); gap:12px; margin-bottom:28px; }</p>
<p class="p1">.summary-card { background:var(--surface); border:1px solid var(--border); border-radius:10px; padding:16px 18px; cursor:pointer; transition:box-shadow 0.12s; }</p>
<p class="p1">.summary-card:hover { box-shadow:0 2px 8px rgba(0,0,0,0.07); }</p>
<p class="p1">.summary-num { font-family:'DM Serif Display',serif; font-size:32px; line-height:1; margin-bottom:4px; }</p>
<p class="p1">.summary-label { font-size:12px; color:var(--text-muted); }</p>
<p class="p2"><br></p>
<p class="p1">.filters { display:flex; gap:6px; margin-bottom:20px; flex-wrap:wrap; }</p>
<p class="p1">.filter-chip { padding:5px 12px; border-radius:20px; border:1px solid var(--border); background:var(--surface); font-size:12.5px; cursor:pointer; transition:all 0.12s; color:var(--text-muted); }</p>
<p class="p1">.filter-chip:hover { border-color:#bbb; color:var(--text); }</p>
<p class="p1">.filter-chip.active { background:var(--text); border-color:var(--text); color:white; font-weight:500; }</p>
<p class="p2"><br></p>
<p class="p1">.task-row {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>display:grid;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>grid-template-columns:32px 60px 1fr 150px 180px 120px;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>align-items:center;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>padding:10px 12px;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>border-radius:7px;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>border:1px solid var(--border);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>transition:all 0.12s;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>background:var(--surface);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>margin-bottom:4px;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>cursor:pointer;</p>
<p class="p1">}</p>
<p class="p1">.task-row:hover { box-shadow:0 1px 6px rgba(0,0,0,0.07); border-color:#d0ccc7; }</p>
<p class="p1">.task-row.done { opacity:0.5; }</p>
<p class="p2"><br></p>
<p class="p1">.task-check { width:18px; height:18px; border-radius:4px; border:1.5px solid var(--border); cursor:pointer; display:flex; align-items:center; justify-content:center; transition:all 0.12s; }</p>
<p class="p1">.task-check:hover { border-color:var(--accent); }</p>
<p class="p1">.task-check.checked { background:var(--accent); border-color:var(--accent); color:white; font-size:11px; }</p>
<p class="p2"><br></p>
<p class="p1">.priority-badge { padding:2px 8px; border-radius:12px; font-size:10px; font-weight:600; display:inline-block; }</p>
<p class="p1">.priority-P1 { background:#FDECEA; color:#A8200D; }</p>
<p class="p1">.priority-P2 { background:#FEF3E8; color:#B8540A; }</p>
<p class="p1">.priority-P3 { background:#FFF9E6; color:#FFC107; }</p>
<p class="p1">.priority-P4 { background:#F0EDE8; color:#8A8178; }</p>
<p class="p2"><br></p>
<p class="p1">.task-content { display:flex; flex-direction:column; gap:2px; }</p>
<p class="p1">.task-name { font-size:13.5px; font-weight:500; }</p>
<p class="p1">.task-meta { font-size:11px; color:var(--text-muted); display:flex; gap:8px; align-items:center; }</p>
<p class="p1">.task-meta-item { display:flex; align-items:center; gap:3px; }</p>
<p class="p2"><br></p>
<p class="p1">.task-assignee { font-size:12.5px; color:var(--text); }</p>
<p class="p1">.task-dept { font-size:12px; color:var(--text-muted); }</p>
<p class="p1">.task-due { font-size:12.5px; color:var(--text-muted); }</p>
<p class="p1">.task-due.overdue { color:var(--danger); font-weight:500; }</p>
<p class="p2"><br></p>
<p class="p1">.task-actions { display:flex; gap:4px; justify-content:flex-end; opacity:0; transition:opacity 0.12s; }</p>
<p class="p1">.task-row:hover .task-actions { opacity:1; }</p>
<p class="p1">.icon-btn { width:26px; height:26px; border-radius:5px; border:1px solid var(--border); background:var(--surface); display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:13px; transition:all 0.12s; }</p>
<p class="p1">.icon-btn:hover { background:var(--bg); }</p>
<p class="p1">.icon-btn.btn-delete:hover { color:var(--danger); }</p>
<p class="p2"><br></p>
<p class="p1">.modal-overlay { display:none; position:fixed; inset:0; background:rgba(26,23,20,0.45); z-index:200; align-items:center; justify-content:center; }</p>
<p class="p1">.modal-overlay.open { display:flex; }</p>
<p class="p1">.modal { background:var(--surface); border-radius:14px; padding:28px; width:560px; max-width:95vw; max-height:90vh; overflow-y:auto; box-shadow:0 20px 60px rgba(0,0,0,0.2); }</p>
<p class="p1">.modal-title { font-family:'DM Serif Display',serif; font-size:20px; margin-bottom:22px; }</p>
<p class="p2"><br></p>
<p class="p1">.form-row { margin-bottom:16px; }</p>
<p class="p1">.form-row label { display:block; font-size:12px; font-weight:500; letter-spacing:0.3px; text-transform:uppercase; color:var(--text-muted); margin-bottom:6px; }</p>
<p class="p1">.form-row input, .form-row select, .form-row textarea { width:100%; padding:9px 12px; border:1px solid var(--border); border-radius:7px; font-size:13.5px; background:var(--bg); color:var(--text); outline:none; transition:border-color 0.12s; font-family:'DM Sans',sans-serif; }</p>
<p class="p1">.form-row input:focus, .form-row select:focus, .form-row textarea:focus { border-color:var(--accent); }</p>
<p class="p1">.form-row textarea { min-height:60px; resize:vertical; }</p>
<p class="p1">.form-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; }</p>
<p class="p2"><br></p>
<p class="p1">.form-section { margin:20px 0; padding:16px; background:var(--surface2); border-radius:8px; }</p>
<p class="p1">.form-section-title { font-size:13px; font-weight:600; margin-bottom:12px; color:var(--text); }</p>
<p class="p2"><br></p>
<p class="p1">.checkbox-group { display:flex; flex-direction:column; gap:8px; }</p>
<p class="p1">.checkbox-item { display:flex; align-items:center; gap:8px; }</p>
<p class="p1">.checkbox-item input { width:18px; height:18px; cursor:pointer; }</p>
<p class="p1">.checkbox-item label { font-size:13px; cursor:pointer; text-transform:none; font-weight:400; margin:0; }</p>
<p class="p2"><br></p>
<p class="p1">.checklist-items { display:flex; flex-direction:column; gap:6px; margin-top:8px; }</p>
<p class="p1">.checklist-item { display:flex; align-items:center; gap:8px; padding:8px; background:var(--surface); border-radius:6px; }</p>
<p class="p1">.checklist-item input[type="text"] { flex:1; border:none; background:transparent; font-size:13px; }</p>
<p class="p1">.checklist-remove { color:var(--danger); cursor:pointer; font-size:16px; }</p>
<p class="p2"><br></p>
<p class="p1">.btn-add-item { padding:6px 12px; background:var(--blue-light); color:var(--blue); border:none; border-radius:6px; font-size:12px; cursor:pointer; margin-top:8px; }</p>
<p class="p2"><br></p>
<p class="p1">.modal-footer { display:flex; justify-content:flex-end; gap:8px; margin-top:24px; }</p>
<p class="p1">.btn-cancel { padding:8px 16px; border-radius:7px; border:1px solid var(--border); background:transparent; font-size:13px; cursor:pointer; color:var(--text-muted); }</p>
<p class="p1">.btn-save { padding:8px 20px; border-radius:7px; border:none; background:var(--accent); color:white; font-size:13px; font-weight:500; cursor:pointer; }</p>
<p class="p2"><br></p>
<p class="p1">.loading { text-align:center; padding:60px; color:var(--text-muted); }</p>
<p class="p1">.spinner { width:28px; height:28px; border:2px solid var(--border); border-top-color:var(--accent); border-radius:50%; animation:spin 0.7s linear infinite; margin:0 auto 12px; }</p>
<p class="p1">@keyframes spin { to{transform:rotate(360deg)} }</p>
<p class="p2"><br></p>
<p class="p1">.toast { position:fixed; bottom:24px; right:24px; background:var(--text); color:white; padding:12px 18px; border-radius:8px; font-size:13px; z-index:300; opacity:0; transform:translateY(8px); transition:all 0.2s; }</p>
<p class="p1">.toast.show { opacity:1; transform:translateY(0); }</p>
<p class="p2"><br></p>
<p class="p1">.comments-section { margin-top:16px; padding-top:16px; border-top:1px solid var(--border); }</p>
<p class="p1">.comment { padding:10px; background:var(--surface2); border-radius:6px; margin-bottom:8px; }</p>
<p class="p1">.comment-header { display:flex; justify-content:space-between; margin-bottom:4px; }</p>
<p class="p1">.comment-author { font-size:12px; font-weight:600; }</p>
<p class="p1">.comment-time { font-size:11px; color:var(--text-muted); }</p>
<p class="p1">.comment-text { font-size:13px; }</p>
<p class="p1">.comment-input { display:flex; gap:8px; margin-top:8px; }</p>
<p class="p1">.comment-input input { flex:1; }</p>
<p class="p1">.comment-input button { padding:6px 12px; background:var(--accent); color:white; border:none; border-radius:6px; cursor:pointer; }</p>
<p class="p1">&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;header&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="header-brand"&gt;Command Centre&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="header-right"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="user-selector"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;select id="user-filter" onchange="setUserFilter()"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;option value=""&gt;View as: Everyone&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="sync-status"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="sync-dot" id="sync-dot"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;span id="sync-label"&gt;Connected&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;button class="btn-add" onclick="openModal()"&gt;+ Add Task&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p1">&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div class="config-banner" id="config-banner"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>âš™ï¸ &lt;strong&gt;Setup:&lt;/strong&gt; Paste your Google Apps Script URL here.</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;input type="text" id="script-url-input" placeholder="https://script.google.com/macros/s/.../exec" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;button class="btn-connect" onclick="saveScriptUrl()"&gt;Connect&lt;/button&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;main&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="summary-bar"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="summary-card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="summary-num" id="s-overdue"&gt;â€”&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="summary-label"&gt;Overdue&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="summary-card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="summary-num" id="s-week"&gt;â€”&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="summary-label"&gt;This Week&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="summary-card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="summary-num" id="s-available"&gt;â€”&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="summary-label"&gt;Available&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="summary-card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="summary-num" id="s-done"&gt;â€”&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="summary-label"&gt;Done&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="filters"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="filter-chip active" data-dept="all" onclick="setDeptFilter('all',this)"&gt;All Departments&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div id="task-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="loading"&gt;&lt;div class="spinner"&gt;&lt;/div&gt;Connect to get started&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p1">&lt;/main&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div class="modal-overlay" id="modal"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="modal"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="modal-title" id="modal-title"&gt;Add New Task&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;label&gt;Task Name&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;input type="text" id="f-name" placeholder="Task description" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="form-grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Department&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;select id="f-dept"&gt;&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Priority&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;select id="f-priority"&gt;&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="form-grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Assignment Type&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;select id="f-assignment-type" onchange="toggleAssignee()"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="individual"&gt;Individual&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="department"&gt;Department (anyone)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="form-row" id="assignee-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Assigned To&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;select id="f-assignee"&gt;&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="form-grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Due Date&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="date" id="f-due" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Recurrence&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;select id="f-recur"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="none"&gt;No recurrence&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="daily"&gt;Every day&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="every-2-days"&gt;Every 2 days&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="every-3-days"&gt;Every 3 days&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="weekly"&gt;Weekly&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="fortnightly"&gt;Fortnightly&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="monthly"&gt;Monthly&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="quarterly"&gt;Quarterly&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;option value="annually"&gt;Annually&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="form-row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;label&gt;Notes (optional)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;textarea id="f-notes" placeholder="Additional context..."&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="form-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="form-section-title"&gt;Checklist (optional)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="checklist-items" id="checklist-items"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;button type="button" class="btn-add-item" onclick="addChecklistItem()"&gt;+ Add Item&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="form-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="form-section-title"&gt;Notifications&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="checkbox-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;input type="checkbox" id="n-assign-assignee" checked /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;label for="n-assign-assignee"&gt;Notify assignee on assignment&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;input type="checkbox" id="n-comment-creator" checked /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;label for="n-comment-creator"&gt;Notify creator on comments&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;input type="checkbox" id="n-comment-assignee" checked /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;label for="n-comment-assignee"&gt;Notify assignee on comments&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;input type="checkbox" id="n-complete-creator" checked /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;label for="n-complete-creator"&gt;Notify creator on completion&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;input type="checkbox" id="n-complete-assignee" checked /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;label for="n-complete-assignee"&gt;Notify assignee on completion&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;input type="checkbox" id="n-overdue" checked /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;label for="n-overdue"&gt;Notify when overdue&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="modal-footer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;button class="btn-cancel" onclick="closeModal()"&gt;Cancel&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;button class="btn-save" onclick="saveTask()"&gt;Save Task&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div class="toast" id="toast"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">const SCRIPT_URL_KEY = 'commandCentreScriptUrl';</p>
<p class="p1">let SCRIPT_URL = localStorage.getItem(SCRIPT_URL_KEY) || '';</p>
<p class="p2"><br></p>
<p class="p1">let tasks = [];</p>
<p class="p1">let team = [];</p>
<p class="p1">let departments = [];</p>
<p class="p1">let priorities = [];</p>
<p class="p1">let currentUser = '';</p>
<p class="p1">let currentDept = 'all';</p>
<p class="p1">let editingId = null;</p>
<p class="p1">let checklistItems = [];</p>
<p class="p2"><br></p>
<p class="p1">window.onload = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (SCRIPT_URL) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('config-banner').classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('script-url-input').value = SCRIPT_URL;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>loadData();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">function saveScriptUrl() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const val = document.getElementById('script-url-input').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (!val.startsWith('https://script.google.com')) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>alert('Please paste a valid Google Apps Script URL');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>SCRIPT_URL = val;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>localStorage.setItem(SCRIPT_URL_KEY, SCRIPT_URL);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('config-banner').classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>loadData();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function setSyncStatus(state) {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const dot = document.getElementById('sync-dot');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const label = document.getElementById('sync-label');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>dot.className = 'sync-dot' + (state === 'syncing' ? ' syncing' : '');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>label.textContent = state === 'syncing' ? 'Syncing...' : 'Connected';</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">async function api(params) {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>setSyncStatus('syncing');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const res = await fetch(SCRIPT_URL, {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>method: 'POST',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>body: JSON.stringify(params)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const data = await res.json();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>setSyncStatus('ok');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return data;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>} catch(e) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>setSyncStatus('error');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>console.error(e);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return { error: e.message };</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">async function loadData() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('task-container').innerHTML = '&lt;div class="loading"&gt;&lt;div class="spinner"&gt;&lt;/div&gt;&lt;p&gt;Loading...&lt;/p&gt;&lt;/div&gt;';</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const [tasksRes, teamRes, deptsRes, prioritiesRes] = await Promise.all([</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>api({ action: 'getTasks' }),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>api({ action: 'getTeam' }),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>api({ action: 'getDepartments' }),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>api({ action: 'getPriorities' })</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>]);</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (tasksRes.success) tasks = tasksRes.tasks;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (teamRes.success) team = teamRes.team;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (deptsRes.success) departments = deptsRes.departments;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (prioritiesRes.success) priorities = prioritiesRes.priorities;</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>populateFilters();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>populateUserFilter();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>renderTasks();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>showToast('Data loaded âœ“');</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function populateFilters() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const filtersDiv = document.querySelector('.filters');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>filtersDiv.innerHTML = '&lt;div class="filter-chip active" data-dept="all" onclick="setDeptFilter(\'all\',this)"&gt;All Departments&lt;/div&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>departments.forEach(d =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>filtersDiv.innerHTML += `&lt;div class="filter-chip" data-dept="${d.id}" onclick="setDeptFilter('${d.id}',this)"&gt;${d.name}&lt;/div&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>});</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function populateUserFilter() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const select = document.getElementById('user-filter');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>select.innerHTML = '&lt;option value=""&gt;View as: Everyone&lt;/option&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>team.forEach(p =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const opt = document.createElement('option');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>opt.value = p.id;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>opt.textContent = `View as: ${p.name}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>select.appendChild(opt);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>});</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function setUserFilter() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>currentUser = document.getElementById('user-filter').value;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>renderTasks();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function setDeptFilter(deptId, el) {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>currentDept = deptId;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.querySelectorAll('.filter-chip').forEach(c =&gt; c.classList.remove('active'));</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>el.classList.add('active');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>renderTasks();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function getFilteredTasks() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let f = [...tasks];</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (currentUser) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const userDept = team.find(t =&gt; t.id === currentUser)?.departmentId;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>f = f.filter(t =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (t.assignmentType === 'individual') return t.assigneeId === currentUser;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return t.departmentId === userDept;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (currentDept !== 'all') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>f = f.filter(t =&gt; t.departmentId === currentDept);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>return f;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function renderTasks() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const container = document.getElementById('task-container');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const filtered = getFilteredTasks();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (filtered.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>container.innerHTML = '&lt;div class="loading"&gt;No tasks&lt;/div&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>updateCounts();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>container.innerHTML = filtered.map(t =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const priority = getPriorityById(t.priorityId);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const assignee = getTeamById(t.assigneeId);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const dept = getDeptById(t.departmentId);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const dueClass = daysFromNow(t.due) &lt; 0 ? 'overdue' : '';</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const checklistProgress = t.checklist ? calculateChecklistProgress(t.checklist, t.checklistCompleted) : '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const lastComment = ''; // TODO: get last comment</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return `&lt;div class="task-row ${t.status==='done'?'done':''}"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="task-check ${t.status==='done'?'checked':''}" onclick="toggleDone('${t.id}',event)"&gt;${t.status==='done'?'âœ“':''}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div&gt;${priority ? `&lt;span class="priority-badge priority-${priority.id}"&gt;${priority.id}&lt;/span&gt;` : ''}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="task-content"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="task-name"&gt;${t.name}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="task-meta"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>${checklistProgress ? `&lt;span class="task-meta-item"&gt;âœ“ ${checklistProgress}&lt;/span&gt;` : ''}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>${lastComment ? `&lt;span class="task-meta-item"&gt;ğŸ’¬ ${lastComment}&lt;/span&gt;` : ''}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="task-assignee"&gt;${assignee ? assignee.name : 'Unassigned'}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="task-dept"&gt;${dept ? dept.name : ''}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="task-due ${dueClass}"&gt;${formatDate(t.due)}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}).join('');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>updateCounts();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function calculateChecklistProgress(checklistJson, completedJson) {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const items = JSON.parse(checklistJson || '[]');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const completed = JSON.parse(completedJson || '[]');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (items.length === 0) return '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return `${completed.length}/${items.length}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>} catch(e) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return '';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function updateCounts() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const overdue = tasks.filter(t =&gt; t.status !== 'done' &amp;&amp; daysFromNow(t.due) &lt; 0).length;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const week = tasks.filter(t =&gt; t.status !== 'done' &amp;&amp; daysFromNow(t.due) &gt;= 0 &amp;&amp; daysFromNow(t.due) &lt;= 7).length;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const available = tasks.filter(t =&gt; t.assignmentType === 'department' &amp;&amp; !t.pickedUpById &amp;&amp; t.status !== 'done').length;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const done = tasks.filter(t =&gt; t.status === 'done').length;</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('s-overdue').textContent = overdue;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('s-week').textContent = week;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('s-available').textContent = available;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('s-done').textContent = done;</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function daysFromNow(dateStr) {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const today = new Date(); today.setHours(0,0,0,0);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const d = new Date(dateStr); d.setHours(0,0,0,0);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>return Math.round((d - today) / 86400000);</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function formatDate(dateStr) {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const diff = daysFromNow(dateStr);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (diff === 0) return 'Today';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (diff === 1) return 'Tomorrow';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (diff === -1) return 'Yesterday';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (diff &lt; 0) return `${Math.abs(diff)}d overdue`;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (diff &lt;= 7) return `In ${diff} days`;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const d = new Date(dateStr + 'T00:00:00');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>return d.toLocaleDateString('en-IN', { day: 'numeric', month: 'short' });</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function getTeamById(id) { return team.find(t =&gt; t.id === id); }</p>
<p class="p1">function getDeptById(id) { return departments.find(d =&gt; d.id === id); }</p>
<p class="p1">function getPriorityById(id) { return priorities.find(p =&gt; p.id === id); }</p>
<p class="p2"><br></p>
<p class="p1">async function toggleDone(id, e) {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>e.stopPropagation();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const task = tasks.find(t =&gt; t.id === id);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (!task) return;</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const newStatus = task.status === 'done' ? 'pending' : 'done';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>await api({ action: 'updateTask', id: task.id, status: newStatus, completedBy: currentUser || 'User' });</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>await loadData();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function openModal() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>editingId = null;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('modal-title').textContent = 'Add New Task';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('f-name').value = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('f-notes').value = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('f-assignment-type').value = 'individual';</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const deptSelect = document.getElementById('f-dept');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>deptSelect.innerHTML = departments.map(d =&gt; `&lt;option value="${d.id}"&gt;${d.name}&lt;/option&gt;`).join('');</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const prioritySelect = document.getElementById('f-priority');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>prioritySelect.innerHTML = priorities.map(p =&gt; `&lt;option value="${p.id}"&gt;${p.name}&lt;/option&gt;`).join('');</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const assigneeSelect = document.getElementById('f-assignee');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>assigneeSelect.innerHTML = '&lt;option value=""&gt;Select...&lt;/option&gt;' + team.map(t =&gt; `&lt;option value="${t.id}"&gt;${t.name}&lt;/option&gt;`).join('');</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const d = new Date(); d.setDate(d.getDate() + 7);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('f-due').value = d.toISOString().split('T')[0];</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('f-recur').value = 'none';</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>checklistItems = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>renderChecklistItems();</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>toggleAssignee();</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('modal').classList.add('open');</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function closeModal() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('modal').classList.remove('open');</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function toggleAssignee() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const type = document.getElementById('f-assignment-type').value;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>document.getElementById('assignee-row').style.display = type === 'individual' ? 'block' : 'none';</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function addChecklistItem() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>checklistItems.push({ text: '', checked: false });</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>renderChecklistItems();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function renderChecklistItems() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const container = document.getElementById('checklist-items');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (checklistItems.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>container.innerHTML = '&lt;div style="font-size:12px;color:var(--text-muted)"&gt;No checklist items&lt;/div&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>container.innerHTML = checklistItems.map((item, i) =&gt; `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="checklist-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;input type="text" value="${item.text}" onchange="checklistItems[${i}].text=this.value" placeholder="Checklist item..." /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;span class="checklist-remove" onclick="removeChecklistItem(${i})"&gt;Ã—&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>`).join('');</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">function removeChecklistItem(idx) {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>checklistItems.splice(idx, 1);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>renderChecklistItems();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">async function saveTask() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const name = document.getElementById('f-name').value.trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (!name) { alert('Please enter a task name'); return; }</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const assignmentType = document.getElementById('f-assignment-type').value;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const assigneeId = assignmentType === 'individual' ? document.getElementById('f-assignee').value : '';</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const data = {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>name,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>departmentId: document.getElementById('f-dept').value,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>priorityId: document.getElementById('f-priority').value,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>assignmentType,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>assigneeId,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>assignedById: currentUser || 'ADMIN',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>due: document.getElementById('f-due').value,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>recurrence: document.getElementById('f-recur').value,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>notes: document.getElementById('f-notes').value.trim(),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>checklist: JSON.stringify(checklistItems.map(i =&gt; i.text).filter(t =&gt; t)),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>notifyAssigneeOnAssign: document.getElementById('n-assign-assignee').checked,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>notifyCreatorOnComment: document.getElementById('n-comment-creator').checked,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>notifyAssigneeOnComment: document.getElementById('n-comment-assignee').checked,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>notifyCreatorOnComplete: document.getElementById('n-complete-creator').checked,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>notifyAssigneeOnComplete: document.getElementById('n-complete-assignee').checked,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>notifyOnOverdue: document.getElementById('n-overdue').checked,</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>};</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>closeModal();</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (editingId) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>await api({ action: 'updateTask', id: editingId, ...data });</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>showToast('Task updated âœ“');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>await api({ action: 'addTask', ...data });</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>showToast('Task created âœ“');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>await loadData();</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">document.getElementById('modal').addEventListener('click', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(e.target === this) closeModal();</p>
<p class="p1">});</p>
<p class="p2"><br></p>
<p class="p1">function showToast(msg) {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const t = document.getElementById('toast');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>t.textContent = msg;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>t.classList.add('show');</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>setTimeout(() =&gt; t.classList.remove('show'), 2800);</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">setInterval(() =&gt; { if (SCRIPT_URL) loadData(); }, 60000);</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
